<!doctype html>
<html lang="en">
  <title>DigiSchool</title>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <link rel="apple-touch-icon" sizes="76x76" href="static/img/apple-icon.png">
  <link rel="icon" type="image/png" href="static/img/favicon.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://jqueryvalidation.org/files/demo/site-demos.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.12/css/bootstrap-select.min.css" />
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
  <link href="static/css/material-dashboard.css?v=2.1.2" rel="stylesheet" />
  
  <style>
    .scroll-box {
            overflow-y: scroll;
            height: 100px;
        }
    .box{
        display: none;
    }
   
    .bootstrap-select .btn:focus {
    outline: none !important;
}
  </style>

<style>
  div.scrollmenu {
    overflow: auto;
    white-space: nowrap;
  }
  
  div.scrollmenu li {
    display: inline-block;
    color: white;
    text-align: center;
    padding: 14px;
    text-decoration: none;
  }
  
  div.scrollmenu li:hover {
    background-color: #777;
  }
  </style>
  
</head>

<body>
  <div class="wrapper ">
    <div class="sidebar" data-color="purple" data-background-color="white">
      <div class="logo">
        <div class="row" >
          <div class="col-sm-2"></div>
          <div class="col-sm-8" >
            <form class="form" method="POST" id="photoForm" enctype="multipart/form-data">
            <label>
              {% if category=="school"%}
              <input type="file" name="file" id="photo" hidden/>
              {%endif%}
              <div class="profile-photo-small" >
                {% if profile==1 %}
                <img src="static/img/faces/profile.png" alt="Circle Image"  style="height:150px;" class="rounded-circle img-fluid">
                {% else %}
                <img src="static/img/faces/{{school_info[0][0]}}.png" alt="Circle Image"  style="height:150px;" class="rounded-circle img-fluid">
                {% endif %}
              </div>
            </label>
          </form>
        </div>
    </div>
        <div style="text-align: center; padding: 10%;">
          <h3>{{ school_info[0][4] }}</h3>
        </div>
      </div>
      <div class="sidebar-wrapper">
        <ul class="nav">
          <li>
            <div>
              <span style="float:left;">
                <i class="material-icons">home</i>
              </span>
              <h4>
                {{school_info[0][2]}}
              </h4>
            </div>
          </li>
          <li>
            <div>
              <span style="float:left;">
                <i class="material-icons">phone</i>
              </span>
              <h4>
                {{school_info[0][1]}}
              </h4>
            </div>
            
          </li>
          <li>
            <div>
              <span style="float:left;">
                <i class="material-icons">email</i>
              </span>
              <h4>
                {{school_info[0][3]}}
              </h4>
            </div>
          </li>
        </ul>
      </div>
    </div>
    <div class="main-panel">
      <nav class="navbar navbar-transparent navbar-color-on-scroll fixed-top navbar-expand-lg" color-on-scroll="100" id="sectionsNav">
        <div class="container-fluid">
          <div class="navbar-translate">
            <button class="navbar-toggler" type="button" data-toggle="collapse" aria-expanded="false" aria-label="Toggle navigation">
              <span class="sr-only">Toggle navigation</span>
              <span class="navbar-toggler-icon"></span>
              <span class="navbar-toggler-icon"></span>
              <span class="navbar-toggler-icon"></span>
            </button>
          </div>
          <div class="collapse navbar-collapse">
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav ml-auto">
              <li class="nav-item">
                <a href="#pablo" class="nav-link">
                  About
                </a>
              </li>
                <li class="nav-item search">
                  
                  <button class="btn btn-round btn-primary" data-toggle="modal" data-target="#loginModal">
                    Login<i class="material-icons">assignment</i>
                
                </button>
                </li>
                <li class="dropdown nav-item user ">
                  <a href="#pablo" class="profile-photo dropdown-toggle nav-link" data-toggle="dropdown">
                    <div class="profile-photo-small">
                    {% if profile1==1 %}
                    <img src="static/img/faces/profile.png" alt="Circle Image" class="rounded-circle img-fluid"">
                    {% else %}
                    <img src="static/img/faces/{{user}}.png" alt="Circle Image" class="rounded-circle img-fluid">
                    {% endif %}
                    </div>
                  </a>
                    <div class="dropdown-menu dropdown-menu-right">
                      <a href="/profile" class="dropdown-header">{{ name }}</a>
                      <a href="/signOut" class="dropdown-item">Sign out</a>
                    </div>
                  
                  
                </li>
                
                <li class="dropdown nav-item schools">
                    <a href="#pablo" class="profile-photo dropdown-toggle nav-link" data-toggle="dropdown">
                      <div class="profile-photo-small">
                      {% if profile==1 %}
                    <img src="static/img/faces/profile.png" alt="Circle Image" class="rounded-circle img-fluid">
                    {% else %}
                    <img src="static/img/faces/{{user}}.png" alt="Circle Image" class="rounded-circle img-fluid">
                    {% endif %}
                    </div>
                    </a>
                      <div class="dropdown-menu dropdown-menu-right">
                        <h6 class="dropdown-header">{{ user }}</h6>
                        <button data-toggle="modal" data-target="#ApprovalsModal" class="dropdown-item">Approvals</button>
                        <a href="/setUp" class="dropdown-item">SetUp</a>
                        <a href="/signOut" class="dropdown-item">Sign out</a>
                     
                    </div>
                    
                  </li>
                </ul>
              </div>
            </div>
        </div>
      </nav>
      <div class="modal fade" id="loginModal" tabindex="-1" role="">
        <div class="modal-dialog modal-login" role="document">
            <div class="modal-content">
                <div class="card card-signup card-plain">
                    <div class="modal-header">
                        <div class="card-header card-header-primary ">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="material-icons">clear</i></button>
                            <h3 class="card-title">Login</h3>
                            <h7>to explore more..</h7>
                        </div>
                    </div>
                    <div class="modal-body">
                        <form class="form" method="POST" action="{{ url_for('login') }}">
                          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                
                            <div class="card-body">
                                <div class="form-group bmd-form-group">
                                    <div class="input-group">
                                        <span class="input-group-addon">
                                            <i class="material-icons">perm_identity</i>
                                        </span>
                                        <input type="text" class="form-control" id="username1" name="username1" placeholder="Username">
                                    </div>
                                </div>
    
                                <div class="form-group bmd-form-group">
                                    <div class="input-group">
                                        <span class="input-group-addon">
                                            <i class="material-icons">lock_outline</i>
                                        </span>
                                        <input type="password" placeholder="Password" id="password1" name="password1" class="form-control">
                                        
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer justify-content-center">
                              <input class="btn btn-primary btn-link btn-wd btn-lg" type = "submit" value="login"/>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="ApprovalsModal" tabindex="-1" role="">
      <div class="modal-dialog modal-login" role="document">
          <div class="modal-content">
              <div class="card card-signup card-plain">
                  <div class="modal-header">
                      <div class="card-header card-header-primary " style="width: 250px;">
                          <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="material-icons">clear</i></button>
                          <h3 class="card-title">Approvals</h3>
                          
                      </div>
                  </div>
                  <div class="modal-body">
                    {% if approvals[1] > 0 %}
                    <div class="teacher">
                      
                      <table>
                        <thead>Teachers</thead>
                        <tbody>
                          {% for i in range(approvals[1]) %}
                          <tr>
                            <td>
                              {{ i+1 }}
                            </td>
                            <td>
                              {{approvals[0][i][8]}}
                            </td>
                            <td>
                              <button class="btn btn-primary btn-link appbox" id="teacher{{i}}"><i class="material-icons">keyboard_arrow_down</i></button>
                              
                            </td>
                            <td id="{{approvals[0][i][0]}}box">
                              <button class="btn btn-success btn-link approvalbox" id="{{approvals[0][i][0]}}">Approve</button>
                              
                            </td>
                            <td id="{{approvals[0][i][0]}}box2">
                              <button class="btn btn-danger btn-link rejectbox" id="{{approvals[0][i][0]}}">Reject</button>
                              
                            </td>
                          </tr>
                          <tr>
                              <table class="infobox" id="teacher{{i}}box" style="width: 70%; text-align: right;">
                                <tbody>
                                  <tr>
                                    <td>
                                      Biodata:
                                    </td>
                                    <td>
                                      {{approvals[0][i][2]}}
                                    </td>
                                    <tr>
                                    <td>
                                      Address:
                                    </td>
                                    <td>
                                      {{approvals[0][i][4]}}
                                    </td>
                                  </tr>
                                  <tr>
                                    <td>
                                      Email:
                                    </td>
                                    <td>
                                      {{approvals[0][i][5]}}
                                    </td>
                                  </tr>
                                  <tr>
                                    <td>
                                      contact:
                                    </td>
                                    <td>
                                      {{approvals[0][i][3]}}
                                    </td>
                                  </tr>
                                </tbody>
                              </table>
                          </tr>
                          {% endfor %}
                        </tbody>
                      </table>
                       
                    </div>
                    {% else %}
                      <div class="note">
                        No teachers approvals pending
                      </div>
                    {% endif %}
                    {% if approvals[3] > 0 %}
                    <div class="student">
                      
                        <table>
                          <thead>Students</thead>
                          <tbody>
                            {% for i in range(approvals[3]) %}
                            <tr>
                              <td>
                                {{ i+1 }}
                              </td>
                              <td>
                                {{approvals[2][i][6]}}
                              </td>
                              <td>
                                <button class="btn btn-primary btn-link appbox" id="student{{i}}"><i class="material-icons">keyboard_arrow_down</i></button>
                                
                              </td>
                              <td id="{{approvals[2][i][0]}}box">
                                <button class="btn btn-success btn-link approvalbox" id="{{approvals[2][i][0]}}">Approve</button>
                                
                              </td>
                              <td id="{{approvals[2][i][0]}}box2">
                                <button class="btn btn-danger btn-link rejectbox" id="{{approvals[2][i][0]}}">Reject</button>
                                
                              </td>
                            </tr>
                            <tr>
                                <table class="infobox" id="student{{i}}box" style="width: 70%; text-align: right;">
                                  <tbody>
                                    <tr>
                                      <td>
                                        Class
                                      </td>
                                      <td>
                                        {{approvals[2][i][1]}}
                                      </td>
                                      <tr>
                                      <td>
                                        Parent/Guardian:
                                      </td>
                                      <td>
                                        {{approvals[2][i][3]}}
                                      </td>
                                    </tr>
                                    
                                  </tbody>
                                </table>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>                      
                    </div>
                    {% else %}
                      <div class="nost">
                        No students approvals pending
                      </div>
                    {% endif %}
                  </div>
              </div>
          </div>
      </div>
  </div>
  <div class="modal fade" id="activityUpload" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Upload School Activity</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form id="activityForm" method="POST" enctype="multipart/form-data">
            <label>Activity Detail:</label>
            <textarea id="textAct" name="activity" style="width: 100%;"  rows="5"></textarea>
            <label>Upload Image:</label>
            <br/>
            <!-- <input type="file" name="file" required /> -->
            <label class="btn btn-info btn-round" style="width:fit-content;">
              <input type="file" name="file" id="activityFile" hidden/>
              <i class="material-icons">cloud_upload</i>
              Image upload
          </label>
            <input  id="filedisplay" style="border: none; padding-top: 3%;padding-left: 1.5%;" type="text" value="No File Selected">
          
          
        <!-- </div> -->
        <!-- <div class="modal-footer"> -->
          <br/><br/>
          <button type="button" onClick="activitySubmit()" class="btn btn-round btn-primary">Save changes</button>
        </form>
        </div>
      </div>
    </div>
  </div>
      <div class="content">
        <div class="container-fluid">
          <div class="row">
            <div class = "col-7">
              <div class="section" id="carousel">
                <div class="container">
                      <!-- Carousel Card -->
                      <div class="card card-raised card-carousel">
                        <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel" data-interval="3000">
                          <ol class="carousel-indicators">
                            <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                            <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                            <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                          </ol>
                          <div class="carousel-inner">
                            <div class="carousel-item active">
                              <img class="d-block w-100" src="static/img/school/{{school_info[0][0]}}img1.jpeg" height="350" alt="First slide">
                              <div class="carousel-caption d-none d-md-block">
                                <h4>
                                  <i class="material-icons">location_on</i> {{ school_info[0][4] }}, {{ school_info[0][2] }}
                                </h4>
                              </div>
                            </div>
                            <div class="carousel-item">
                              <img class="d-block w-100" src="static/img/school/{{school_info[0][0]}}img2.jpg" height="350" alt="Second slide">
                              <div class="carousel-caption d-none d-md-block">
                                <h4>
                                  <i class="material-icons">location_on</i>{{ school_info[0][4] }}, {{ school_info[0][2] }} 
                                </h4>
                              </div>
                            </div>
                            <div class="carousel-item">
                              <img class="d-block w-100" src="static/img/school/{{school_info[0][0]}}img3.jpg" height="350" alt="Third slide">
                              <div class="carousel-caption d-none d-md-block">
                                <h4>
                                  <i class="material-icons">location_on</i> {{ school_info[0][4] }}, {{ school_info[0][2] }}
                                </h4>
                              </div>
                            </div>
                          </div>
                          <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                            <i class="material-icons">keyboard_arrow_left</i>
                            <span class="sr-only">Previous</span>
                          </a>
                          <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                            <i class="material-icons">keyboard_arrow_right</i>
                            <span class="sr-only">Next</span>
                          </a>
                        </div>
                      </div>
                </div>
              </div>
            </div>
            <div class= "col-5"  >
              <div class="card " style="height:350px" >
                <!-- <div class="card-header card-header-primary">
                  Activities
                </div> -->
                <div class="card-header card-header-primary container-fluid">
                  <div class="row">
                    <div class="col-sm-8">
                      <h3>Activities</h3>
                    </div>
                    <div class="col-sm-4 float-right schools">
                      <button class="btn btn-link btn-dark" type="button" data-toggle="modal" data-target="#activityUpload"> <i class="material-icons">edit</i></button>
                     </div>
                  </div>
                </div>
                <div class="card-body scroll-box">
                  <ul class="list-group list-group-flush">
                    {% if activity|length == 0 %}
                    <p>No Activities to Display.</p>
                    {% else %}
                    {% for i in activity %}
                    <li class="list-group-item">
                      {% if i[1] == none %}
                        {% else %}
                        <div >
                          <img src="{{i[1]}}" class="img-fluid">
          
                        </div>
                        {% endif %}
                        <br/>
                        <div >
                          <h5>{{i[0]}}</h5>
                        </div>
                      <hr/>
                    </li>
                    {% endfor %}
                    {% endif %}
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="card">
                <div class="card-header card-header-primary">
                  <h5 class="card-title  " >Comments</h5>
                  <h6 class="card-subtitle ">An insight on the school</h6>
                </div>
                <div class="card-body ">
                  <div id="nocom">
                    No comments to display
                  </div>
                  <div id="com">
                    <table class="table scroll-box"  style="max-height: 500px;">
                      <tbody>
                        {% for i in range(school_comments[1]) %}
                        <tr>
                          <td>
                            {{ i+1 }}
                          </td>
                          <td>
                            <span class="title"> 
                              <b>{{school_comments[0][i][3]}}</b> ({{school_comments[0][i][6]}})
                              <br>
                              <p>{{ school_comments[0][i][2]}}</p>
                              
                          </span>
                          </td>
                          <td>
                            <div class="row">
                              {% if school_comments[0][i][7] ==2 %}
                                <div class="col-sm-4">
                                  <button id="{{school_comments[0][i][0]}}" type="button" rel="tooltip" title="Upvote" class="btn btn-success btn-link" disabled>
                                    {{ school_comments[0][i][4]}} <i class="material-icons">keyboard_arrow_up</i>
                                  </button>
                                </div>
                                <div class="col-sm-4">
                                  <button id="{{school_comments[0][i][0]}}" type="button" rel="tooltip" title="downvote" class="btn btn-info btn-link" disabled>
                                    {{ school_comments[0][i][5]}} <i class="material-icons">keyboard_arrow_down</i> 
                                  </button>
                                </div>
                              {% else %}
                                <div class="col-sm-4">
                                  <button id="{{school_comments[0][i][0]}}" type="button" rel="tooltip" title="Upvote" class="btn btn-success btn-link upvoteButton">
                                    {{ school_comments[0][i][4]}} <i class="material-icons">keyboard_arrow_up</i>
                                  </button>
                                </div>
                                <div class="col-sm-4">
                                  <button id="{{school_comments[0][i][0]}}" type="button" rel="tooltip" title="downvote" class="btn btn-info btn-link downvoteButton">
                                    {{ school_comments[0][i][5]}} <i class="material-icons">keyboard_arrow_down</i> 
                                  </button>
                                </div>
                              {% endif %}
                            </div>
                          </td>
                            </tr>
                            {% endfor %}
                    </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row" id="comment">
            <div class="col">
              <div class="card" >
                <div class="card-body">
                  <h5 class="card-title">Comment</h5>
                  <h6 class="card-subtitle mb-2 text-muted">Share your experience</h6>
                  <br><br>
                  <form method="POST" action="{{ url_for('comment') }}">
                    <input type="hidden" name="school" value="{{ school_info[0][0] }}" />
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <textarea rows="5" name="comment" style="width: 100%;" placeholder="What do you think about this school?"></textarea>
                    <input class="btn btn-primary " type="submit" value="Share">
                </form>
                </div>
              </div>
            </div>
          </div>
          </div>
        </div>
      </div>
      <footer class="footer footer-default">
        <div class="container">
          <div class="float-left">
            
          </div>
          <div class="copyright float-right">
            &copy;
            <script>
              document.write(new Date().getFullYear())
            </script>, made with <i class="material-icons">favorite</i> by
            <a href="https://github.com/shubhanginigam18/" target="blank">Shuhangi</a> &
            <a href="https://github.com/anaghrao-99/" target="blank">Anagh</a>
            for a better web.
          </div>
        </div>
      </footer>
    </div>
  <script src="static/js/core/jquery.min.js" type="text/javascript"></script>
  <script src="static/js/core/popper.min.js" type="text/javascript"></script>
  <script src="static/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
  <script src="static/js/plugins/moment.min.js"></script>
  <script src="static/js/material-kit.js?v=2.0.6" type="text/javascript"></script>
  <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.11.1/jquery.validate.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
	<script src="static/js/plugins/nouislider.min.js" type="text/javascript"></script>
  <script src="static/js/notify.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/js/bootstrap-select.min.js"></script>
  <script>
    $("#photo").change(function(){
      formName = "#photoForm" 
      var form = $(formName)[0];
      var formData = new FormData(form);
      $.ajax({
        url : '/uploadPhoto',
            type: 'POST',
            enctype: 'multipart/form-data',
            data: formData,
            processData: false,
            contentType: false,
            success:function(data){
              console.log("success")
              location.reload();
              
            },
            error: function(data) {
              
            },
        }).done(function(data) {
          console.log("done")
        });
    });

    function activitySubmit(){
      event.preventDefault();
      formName = "#activityForm"
      var form = $(formName)[0];
      console.log(form)
      var formData = new FormData(form)
      console.log(formData.get('file')['name'])
      // if(formData.get('file')['name'] == ""){
      //   $("#filedisplay").notify("Please select a file","danger")
      // }
      if(formData.get('activity') == "")
      {
        $("#textAct").notify("Please provide details","danger")
      }
      else{
        $.ajax({
            url : '/uploadActivity',
            type: 'POST',
            enctype: 'multipart/form-data',
            data: formData,
            processData: false,
            contentType: false,
            success:function(data){
              console.log("success")
              $.notify("Saved","success")  
              location.reload();            
            },
            error: function(data) {
              console.log("error")
            },
        }).done(function(data) {
          $("#filedisplay").val("No File Selected")
        });
      }
    }
  </script>
  <script>
    $("#activityFile").change(function(e){
      var fileName = e.target.files[0].name;
      $("#filedisplay").val(fileName)
      
    });
  </script>
  <script>

$(document).ready(function(){
      $(".infobox").hide()
    });

    $(".appbox").click(function(){
      $(".infobox").hide()
      i = this.id
      box = "#"+i+"box"
      $(box).show()

    });



    $(document).ready(function(){
      $("#nocom").hide();
      if('{{school_comments[1]}}' == 0){
        $("#nocom").show();
      }
      else{
        $("#nocom").hide();
      }
      
    });

    
    
    $(document).ready(function(){
      if('{{ editAllowed }}' == "N"){
        $("#comment").hide();
      }
    });
    $(document).ready(function(){
      if('{{user}}' == ""){
        $(".user").hide();
        $(".schools").hide();
      }
      else{
        if('{{school_info[0][0]}}'== '{{user}}'){
          $(".user").hide();
          $(".search").hide();
        }
        else{
          $(".schools").hide();
          $(".search").hide();
        }
        
      }
      console.log('{{user}}')
    });

    $(document).ready(function() {
      console.log('{{approvals}}')
      var message = '{{msg}}'
      $.notify(message,"info")
    });

    $(function() {
      $('.selectpicker').selectpicker();
    });

    $(".upvoteButton").click(function(){
      console.log("hi")
      data = {
        id : this.id,
        vote: 1
      }
      console.log(data)
      $.ajax({
          url: '/vote',
          type: 'POST',
          data: JSON.stringify(data),
          dataType: "json",
          contentType: 'application/json;charset=UTF-8',
          processData: false,
          success: function ( data ){
            if(data.msg == "Issue"){
            $.notify(data.msg, "Internal issue");}
            else{
              location.reload(true);
              $.notify(data.msg, "success");
              }
            
          },
          error: function(data) {
            $.notify("Error", {align:"center", verticalAlign:"top"});
          },
      }).done(function(data) {
      });
    });


    $(".approvalbox").click(function(){
      username = this.id;
      console.log(username);
      $.ajax({
          url: '/approve',
          type: 'POST',
          data: username,
          dataType: "json",
          contentType: false,
          processData: false,
          
          success: function ( data ){
            if(data.msg == "Issue"){
            $.notify(data.msg, "Internal issue");}
            else{
              id = "#" + username +"box2"
              $(id).html("<div class='btn btn-success btn-link'><i class='material-icons'>done</i></div>")
              id = "#" + username +"box"
              $(id).html("");
              }
            
          },
          error: function(data) {
            $.notify("Error", {align:"center", verticalAlign:"top"});
          },
      }).done(function(data) {
      });
    });

    $(".rejectbox").click(function(){
      user = this.id;
      $.ajax({
          url: '/reject',
          type: 'POST',
          data: user,
          dataType: "json",
          contentType: false,
          processData: false,
          
          success: function ( data ){
            if(data.msg == "Issue"){
            $.notify(data.msg, "Internal issue");}
            else{
              id = "#" + username +"box2"
              $(id).html("<div class='btn btn-danger btn-link'><i class='material-icons'>done</i></div>")
              id = "#" + username +"box"
              $(id).html("");
              }
            
          },
          error: function(data) {
            $.notify("Error", {align:"center", verticalAlign:"top"});
          },
      }).done(function(data) {
      });
    });

    $(".downvoteButton").click(function(){
      data = {
        id : this.id,
        vote: -1
      }
      $.ajax({
          url: '/vote',
          type: 'POST',
          data: JSON.stringify(data),
          dataType: "json",
          contentType: 'application/json;charset=UTF-8',
          processData: false,
          
          success: function ( data ){
            if(data.msg == "Issue"){
            $.notify(data.msg, "Internal issue");}
            else{
              location.reload(true);
              $.notify(data.msg, "success");
              }
            
          },
          error: function(data) {
            $.notify("Error", {align:"center", verticalAlign:"top"});
          },
      }).done(function(data) {
      });
    });


    var csrf_token = "{{ csrf_token() }}";
    console.log(csrf_token)

    $.ajaxSetup({
        beforeSend: function(xhr, settings) {
            if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", csrf_token);
            }
        }
    });
  </script>
</body>

</html>